export const ORIENTATION = {
    HORIZONTAL: "horizontal",
    VERTICAL: "vertical",
};

export const generate = (width, height, x, y, orientation, walls) => {
    // console.log(
    //     `width: ${width}; height: ${height}; x: ${x}; y: ${y} orientation: ${orientation}`
    // );
    if (width < 2 || height < 2) return;

    let horizontal = orientation === ORIENTATION.HORIZONTAL;

    // where will the wall be drawn from?
    let wx = x + (horizontal ? 0 : getRandomInt(width - 2));
    let wy = y + (horizontal ? getRandomInt(height - 2) : 0);

    // where will the passage through the wall exist?
    let px = wx + (horizontal ? getRandomInt(width) : 0);
    let py = wy + (horizontal ? 0 : getRandomInt(height));

    // what direction will the wall be drawn?
    let dx = horizontal ? 1 : 0;
    let dy = horizontal ? 0 : 1;

    // how long will the wall be?
    let length = horizontal ? width : height;

    for (let i = 0; i < length; i++) {
        if (wx !== px || wy !== py) {
            let id = `${wy}-${wx}`;
            walls.push(id);
        }
        wx += dx;
        wy += dy;
    }

    let nx = x,
        ny = y,
        w,
        h;
    if (horizontal) {
        w = width;
        h = wy - y + 1;
    } else {
        w = wx - x + 1;
        h = height;
    }
    generate(w, h, nx, ny, chooseOrientation(w, h), walls);

    if (horizontal) {
        nx = x;
        ny = wy + 1;
        w = width;
        h = y + height - wy - 1;
    } else {
        nx = wx + 1;
        ny = y;
        w = x + width - wx - 1;
        h = height;
    }
    generate(w, h, nx, ny, chooseOrientation(w, h), walls);
};

export const chooseOrientation = (width, height) => {
    if (width < height) return ORIENTATION.HORIZONTAL;
    else if (height < width) return ORIENTATION.VERTICAL;
    else
        return getRandomInt(2) === 0
            ? ORIENTATION.HORIZONTAL
            : ORIENTATION.VERTICAL;
};

const getRandomInt = (max) => Math.floor(Math.random() * Math.floor(max));
